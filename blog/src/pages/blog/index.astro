---
import { getCollection } from "astro:content";
const posts = await getCollection("blog");
const sorted = posts.sort((a,b) => new Date(b.data.pubDate) - new Date(a.data.pubDate));
---
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Blog</title>
    <meta name="description" content="Locksmith tips, guides, and news." />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <style>
      :root { --max: 900px; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial; }
      body { margin:0; padding:0 1rem 4rem; display:grid; place-items:center; }
      main { max-width: var(--max); width:100%; }
      .card { padding:1rem; border:1px solid #eee; border-radius:14px; margin:1rem 0; }
      a { text-decoration:none; }
      small { color:#666; }
    </style>
  </head>
  <body>
    <main>
      <h1>Blog</h1>
      {sorted.map(({ slug, data }) => (
        <div class="card">
          <a href={`/blog/${slug}/`}><h3>{data.title}</h3></a>
          <small>{new Date(data.pubDate).toDateString()}</small>
          <p>{data.description}</p>
        </div>
      ))}
      <p><a href="/rss.xml">RSS</a></p>
    </main>
  </body>
</html>